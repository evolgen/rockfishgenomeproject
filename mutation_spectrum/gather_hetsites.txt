for species in `ls`; do for chr in `find $species/Illumina/ -type d | sed 's#.*/##'`; do for id in `ls $species/Illumina/$chr | grep vcf.gz | sed s/\.vcf\.gz//g`; do bedtools intersect -a $species/Illumina/$chr/$id.vcf.gz -b $species/Illumina/$chr/$id.callable.bed.gz | grep "0/1" | cut -f 1,2,4,5 | sed s/^/$species\      $id\    /g >> $species/Illumina/$id.hetsites.txt; done; done; done
for species in `ls`; do for chr in `find $species/Illumina/ -type d | sed 's#.*/##'`; do for id in `ls $species/Illumina/$chr | grep vcf.gz | sed s/\.vcf\.gz//g`; do bedtools intersect -a $species/Illumina/$chr/$id.vcf.gz -b $species/Illumina/$chr/$id.callable.bed.gz | grep "0/1" | cut -f 1,2,4,5 | sed s/^/$species\   $id\    /g >> $species/Illumina/$id.hetsites.txt; done;  done; gzip $species/Illumina/*.hetsites.txt; echo $species; done  
for species in `ls`; do  for id in `ls $species/Illumina | grep hetsites.txt | sed s/\.hetsites\.txt//g`; do cat $species/Illumina/$id.hetsites.txt | perl /global/scratch/gregoryowens/sebastes/bin/filter_site_spacing.pl | perl /global/scratch/gregoryowens/sebastes/bin/get_surrounding_bases.pl $species/Illumina/$id.tmp /global/scratch/gregoryowens/sebastes/snp_calling/*/$species/referencegenome.fasta > $species/Illumina/$id.hetsites.filtered.txt;  done; done;
